(this["webpackJsonpweather-app"]=this["webpackJsonpweather-app"]||[]).push([[0],{39:function(e,t,a){},40:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var c=a(1),n=a(0),r=a.n(n),s=a(13),i=a.n(s),o=(a(39),a(40),a(3)),d=a.p+"static/media/logo-big.5210dd0a.svg",l=a(17),u=a(5),j=a(7),b=a.n(j),O=a(11),p=a(33),f=a(4);function h(e){return{type:"FETCH_CHOSEN_LOCATION_SUCCESS",payload:e}}function v(e){var t=e.id;return function(){var e=Object(O.a)(b.a.mark((function e(a){var c,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a({type:"FETCH_CHOSEN_LOCATION_PENDING"}),"http://api.openweathermap.org/data/2.5/weather","cfef6851883684acafd83bd9c8128de5",e.prev=3,e.next=6,fetch("".concat("http://api.openweathermap.org/data/2.5/weather","?id=").concat(t,"&appid=").concat("cfef6851883684acafd83bd9c8128de5","&units=metric"));case 6:return c=e.sent,e.next=9,c.json();case 9:n=e.sent,a(h(n)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),a({type:"FETCH_CHOSEN_LOCATION_ERROR",error:e.t0});case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}()}var m={pending:!1,data:null,error:null};function _(e){var t=e.id;return function(){var e=Object(O.a)(b.a.mark((function e(a){var c,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a({type:"FETCH_FORECAST_PENDING"}),"http://api.openweathermap.org/data/2.5/forecast","cfef6851883684acafd83bd9c8128de5",e.prev=3,e.next=6,fetch("".concat("http://api.openweathermap.org/data/2.5/forecast","?id=").concat(t,"&appid=").concat("cfef6851883684acafd83bd9c8128de5","&units=metric"));case 6:return c=e.sent,e.next=9,c.json();case 9:n=e.sent,a({type:"FETCH_FORECAST_SUCCESS",payload:n}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),a({type:"FETCH_FORECAST_ERROR",error:e.t0});case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}()}var x={pending:!1,data:null,error:null};var N=a(19);function g(e){var t=new Date(1e3*e),a=t.getHours(),c=t.getMinutes();return{date:t.getDate(),fullDay:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()],day:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()],hours:a<10?"0".concat(a):a,minutes:c<10?"0".concat(c):c}}function y(e){return"".concat(Math.round(e),"\xb0C")}var E=function(e){return null},S=function(e){return null};function C(){return(C=Object(O.a)(b.a.mark((function e(t){var a,c,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.city,"http://api.openweathermap.org/data/2.5/weather","cfef6851883684acafd83bd9c8128de5",e.next=5,fetch("".concat("http://api.openweathermap.org/data/2.5/weather","?q=").concat(a,"&appid=").concat("cfef6851883684acafd83bd9c8128de5","&units=metric"));case 5:return c=e.sent,e.next=8,c.json();case 8:return n=e.sent,e.abrupt("return",n);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=function(e){var t,a=e.isDataPending,r=Object(n.useState)(!1),s=Object(l.a)(r,2),i=s[0],d=(s[1],Object(n.useState)({})),j=Object(l.a)(d,2),b=j[0],O=j[1],f=Object(o.g)(),m=Object(u.c)((function(e){return e.forecast})),x=Object(u.b)(),g=(t="chosenLocationsHistory",JSON.parse(localStorage.getItem(t)));function y(e){return function(e){return C.apply(this,arguments)}({city:e}).then((function(e){return 200===e.cod?(O(e),[{value:e.id,label:"".concat(e.name," (").concat(e.sys.country,")")}]):[]}))}Object(n.useEffect)((function(){m.pending&&f.push("/card")}),[m]);var w="select".concat(i?" select--show-menu":"");return Object(c.jsx)(p.a,{className:w,classNamePrefix:"select",placeholder:"Search by city...",isLoading:a,defaultOptions:g,loadOptions:function(e){var t=e.trim();return t.length<3?Promise.resolve():y(t)},onChange:function(e){var t=e.value,a=e.label;b.id?x(h(b)):x(v({id:t})),x(_({id:t})),function(e,t){var a=JSON.parse(localStorage.getItem(e)),c=[];a?a.find((function(e){return e.value===t.value}))?c=[t].concat(Object(N.a)(a.filter((function(e){return e.value!==t.value})))):(c=[t].concat(Object(N.a)(a))).length>5&&(c.length=5):c.push(t),localStorage.setItem(e,JSON.stringify(c))}("chosenLocationsHistory",{value:t,label:a}),f.push("/card")},components:{DropdownIndicator:E,IndicatorSeparator:S}})};function k(e){return{type:"GET_USER_LOCATION_ERROR",error:e}}var T={pending:!1,data:null,error:null};var R=function(){var e=Object(u.c)((function(e){return e.userLocation})),t=Object(u.b)();return Object(c.jsx)("button",{type:"button",onClick:function(){e.data?(t(v({id:e.data.id})),t(_({id:e.data.id}))):t(function(){var e=Object(O.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.navigator.geolocation?(t({type:"GET_USER_LOCATION_PENDING"}),window.navigator.geolocation.getCurrentPosition((function(e){var a=e.coords,c=a.latitude,n=a.longitude;Object(O.a)(b.a.mark((function e(){var a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=2,e.next=5,fetch("".concat("http://api.openweathermap.org/data/2.5/weather","?lat=").concat(c,"&lon=").concat(n,"&appid=").concat("cfef6851883684acafd83bd9c8128de5","&units=metric"));case 5:return a=e.sent,e.next=8,a.json();case 8:r=e.sent,t({type:"GET_USER_LOCATION_SUCCESS",payload:{id:r.id}}),t(v({id:r.id})),t(_({id:r.id})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),t(k(e.t0));case 17:case"end":return e.stop()}}),e,null,[[2,14]])})))()}),(function(e){t(k(e))}))):t(k(new Error("Can't access the location")));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},children:"Current location"})};var I=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],r=t[1],s=Object(u.c)((function(e){return e.userLocation}));Object(n.useEffect)((function(){s.pending?r(!0):r(!1)}),[s.pending]);var i="search-form".concat(a?" data-pending":"");return Object(c.jsxs)("form",{className:i,children:[Object(c.jsx)(w,{isDataPending:a}),Object(c.jsx)(R,{})]})};var H=function(){return Object(c.jsx)("div",{className:"page-wrapper",children:Object(c.jsxs)("div",{className:"page-container",children:[Object(c.jsx)("img",{src:d,className:"logo-big"}),Object(c.jsx)(I,{})]})})},F=a(15);var L=function(){var e=Object(u.c)((function(e){return e.chosenLocation})),t="",a="",n="";if(!e.data||200!=e.data.cod)return null;var r=g(e.data.dt);t="".concat(r.fullDay,", ").concat(r.hours,":").concat(r.minutes);var s=g(e.data.sys.sunrise);a="".concat(s.hours,":").concat(s.minutes);var i,o=g(e.data.sys.sunset);return n="".concat(o.hours,":").concat(o.minutes),Object(c.jsxs)("div",{className:"card__module current-weather",children:[Object(c.jsx)("h2",{className:"module-title",children:t}),Object(c.jsxs)("div",{className:"info-blocks",children:[Object(c.jsxs)("div",{className:"info-block",children:[Object(c.jsx)("div",{className:"info-block__title",children:"Temperature:"}),Object(c.jsxs)("div",{className:"info-block__value",children:[y(e.data.main.temp)," ",Object(c.jsxs)("span",{className:"info-block__value-sm",children:["(feels like ",y(e.data.main.feels_like),")"]})]})]}),Object(c.jsxs)("div",{className:"info-block",children:[Object(c.jsx)("div",{className:"info-block__title",children:"Pressure:"}),Object(c.jsx)("div",{className:"info-block__value",children:e.data.main.pressure})]}),Object(c.jsxs)("div",{className:"info-block",children:[Object(c.jsx)("div",{className:"info-block__title",children:"Humidity:"}),Object(c.jsxs)("div",{className:"info-block__value",children:[e.data.main.humidity,"%"]})]}),Object(c.jsxs)("div",{className:"info-block",children:[Object(c.jsx)("div",{className:"info-block__title",children:"Wind:"}),Object(c.jsx)("div",{className:"info-block__value",children:(i=e.data.wind,"".concat(Math.round(i.speed)," m/s"))})]}),Object(c.jsxs)("div",{className:"info-block",children:[Object(c.jsx)("div",{className:"info-block__title",children:"Sunrise:"}),Object(c.jsx)("div",{className:"info-block__value",children:a})]}),Object(c.jsxs)("div",{className:"info-block",children:[Object(c.jsx)("div",{className:"info-block__title",children:"Sunset:"}),Object(c.jsx)("div",{className:"info-block__value",children:n})]})]})]})};var D=function(){var e=Object(u.c)((function(e){return e.forecast})),t=[];return e.data&&200==e.data.cod?(t=e.data.list.reduce((function(e,t,a,c){return(new Date).getDate()===g(t.dt).date||e.find((function(e){return g(e.dt).date===g(t.dt).date}))||14!==g(t.dt).hours?Object(N.a)(e):[].concat(Object(N.a)(e),[t])}),[]),Object(c.jsxs)("div",{className:"card__module forecast",children:[Object(c.jsx)("h2",{className:"module-title",children:"Weekly Forecast"}),Object(c.jsx)("div",{className:"days",children:t.map((function(e){var t=g(e.dt),a="".concat(t.day,", ").concat(t.date);return Object(c.jsxs)("div",{className:"day",children:[Object(c.jsx)("h3",{className:"day__title",children:a}),Object(c.jsx)("div",{className:"info-blocks",children:Object(c.jsxs)("div",{className:"info-block",children:[Object(c.jsx)("div",{className:"info-block__title",children:"Daytime:"}),Object(c.jsxs)("div",{className:"info-block__value",children:[y(e.main.temp)," ",Object(c.jsx)("br",{}),Object(c.jsxs)("span",{className:"info-block__value-sm",children:["(feels like ",y(e.main.feels_like),")"]})]})]})})]},e.dt)}))})]})):null},A=a.p+"static/media/cloud-simple.d4345447.svg";var G=function(){return Object(c.jsx)("div",{className:"preloader",children:Object(c.jsxs)("div",{className:"preloader__wrapper",children:[Object(c.jsx)("img",{src:A,className:"preloader__filler"}),Object(c.jsx)("img",{src:A,className:"preloader__filler"}),Object(c.jsxs)("div",{className:"preloader__containers",children:[Object(c.jsx)("div",{className:"preloader__container"}),Object(c.jsx)("div",{className:"preloader__container"})]})]})})};var P=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],r=t[1],s=Object(u.c)((function(e){return e.chosenLocation})),i=Object(u.c)((function(e){return e.forecast}));return Object(n.useEffect)((function(){r(!0)}),[]),s.pending||i.pending?Object(c.jsx)("div",{className:"page-wrapper",children:Object(c.jsx)("div",{className:"page-container page-container--center",children:Object(c.jsx)(G,{})})}):s.data&&i.data?Object(c.jsx)("div",{className:"page-wrapper",children:Object(c.jsxs)("div",{className:"page-container",children:[Object(c.jsxs)(F.b,{to:"/",className:"nav-link",children:[Object(c.jsx)("span",{children:"\u2190"})," search for another location"]}),Object(c.jsxs)("div",{className:"card animate".concat(a?" animated":""),children:[Object(c.jsxs)("h1",{className:"card__title",children:["Weather for ",s.data.name," (",s.data.sys.country,") "]}),Object(c.jsx)(L,{}),Object(c.jsx)(D,{})]})]})}):Object(c.jsx)(o.a,{to:"/"})};var U=function(){return Object(c.jsx)("div",{id:"app",children:Object(c.jsxs)(o.d,{children:[Object(c.jsx)(o.b,{exact:!0,path:"/",children:Object(c.jsx)(H,{})}),Object(c.jsx)(o.b,{exact:!0,path:"/card",children:Object(c.jsx)(P,{})})]})})},M=a(16),W=a(31),J=a(32),q=Object(M.combineReducers)({chosenLocation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_CHOSEN_LOCATION_PENDING":return Object(f.a)(Object(f.a)({},e),{},{pending:!0});case"FETCH_CHOSEN_LOCATION_SUCCESS":return Object(f.a)(Object(f.a)({},e),{},{pending:!1,data:t.payload});case"FETCH_CHOSEN_LOCATION_ERROR":return Object(f.a)(Object(f.a)({},e),{},{pending:!1,error:t.error});default:return e}},forecast:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_FORECAST_PENDING":return Object(f.a)(Object(f.a)({},e),{},{pending:!0});case"FETCH_FORECAST_SUCCESS":return Object(f.a)(Object(f.a)({},e),{},{pending:!1,data:t.payload});case"FETCH_FORECAST_ERROR":return Object(f.a)(Object(f.a)({},e),{},{pending:!1,error:t.error});default:return e}},userLocation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_USER_LOCATION_PENDING":return Object(f.a)(Object(f.a)({},e),{},{pending:!0});case"GET_USER_LOCATION_SUCCESS":return Object(f.a)(Object(f.a)({},e),{},{pending:!1,data:t.payload});case"GET_USER_LOCATION_ERROR":return Object(f.a)(Object(f.a)({},e),{},{pending:!1,error:t.error});default:return e}}}),B=Object(M.createStore)(q,Object(W.composeWithDevTools)(Object(M.applyMiddleware)(J.a)));i.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(u.a,{store:B,children:Object(c.jsx)(F.a,{children:Object(c.jsx)(U,{})})})}),document.getElementById("root"))}},[[55,1,2]]]);
//# sourceMappingURL=main.d8ebb868.chunk.js.map